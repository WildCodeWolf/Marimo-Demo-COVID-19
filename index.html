<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='read' hidden></marimo-mode>
    <marimo-version data-version='0.13.15' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"theme": "system", "code_editor_font_size": 14, "cell_output": "above", "dataframes": "rich", "default_width": "full", "default_table_page_size": 10}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "reactive_tests": true, "on_cell_change": "autorun", "watcher_on_save": "lazy", "output_max_bytes": 8000000, "std_stream_max_bytes": 1000000, "default_sql_output": "auto"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "language_servers": {"pylsp": {"enabled": true, "enable_mypy": true, "enable_ruff": true, "enable_flake8": false, "enable_pydocstyle": false, "enable_pylint": false, "enable_pyflakes": false}}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "full", "app_title": "Arctic Neural | Demo: COVID-19", "sql_output": "auto"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>Arctic Neural | Demo: COVID-19</title>
    <script type="module" crossorigin src="./assets/index-aRpq2G87.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-BqXWXM9d.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.13.15%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22%2C%20app_title%3D%22Arctic%20Neural%20%7C%20Demo%3A%20COVID-19%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20altair%20as%20alt%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20from%20sklearn.datasets%20import%20fetch_openml%20%20%23%20for%20loading%20the%20dataset%0A%20%20%20%20from%20vega_datasets%20import%20data%20as%20geo%20%20%23%20for%20loading%20geographical%20data%0A%20%20%20%20from%20pycountry%20import%20countries%0A%20%20%20%20return%20alt%2C%20countries%2C%20fetch_openml%2C%20geo%2C%20mo%2C%20pd%0A%0A%0A%40app.cell%0Adef%20_(fetch_openml%2C%20pd)%3A%0A%20%20%20%20%23%20Retrieve%20the%20data%20from%20OpenML%0A%20%20%20%20data%20%3D%20fetch_openml(data_id%3D43412%2C%20as_frame%3DTrue)%0A%20%20%20%20df_%20%3D%20data.data%20%20%23%20original%20data%20frame%0A%20%20%20%20df%20%3D%20df_.copy()%20%20%23%20the%20frame%20we%20are%20going%20to%20work%20with%0A%20%20%20%20df.Date%20%3D%20pd.to_datetime(df.Date)%0A%20%20%20%20features%20%3D%20data.feature_names%0A%20%20%20%20prettify%20%3D%20%7Bf%3A%20f.replace(%22_%22%2C%20%22%20%22)%20for%20f%20in%20features%7D%0A%20%20%20%20descr%20%3D%20data.DESCR%0A%20%20%20%20details%20%3D%20data.details%0A%20%20%20%20url%20%3D%20data.url%0A%20%20%20%20return%20descr%2C%20details%2C%20df%2C%20features%2C%20prettify%2C%20url%0A%0A%0A%40app.cell%0Adef%20_(descr%2C%20details%2C%20df%2C%20format_date%2C%20mo%2C%20show_dataset_details%2C%20url)%3A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Arctic%20Neural%3A%20COVID-19%20Demo%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20This%20is%20a%20little%20visual%20demo%20focusing%20on%20a%20dashboad-like%0A%20%20%20%20%20%20%20%20%20%20%20%20presentation%20of%20a%20publicly%20available%20dataset.%20%20It%20can%20be%0A%20%20%20%20%20%20%20%20%20%20%20%20found%20on%20OpenML%20(%7Burl%7D)%20and%20contains%20the%20number%20of%20COVID-19%0A%20%20%20%20%20%20%20%20%20%20%20%20occurences%20across%20the%20world%20from%20%7Bformat_date(df.Date.min())%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20to%20%7Bformat_date(df.Date.max())%7D.%20%20Not%20all%20countries%20are%0A%20%20%20%20%20%20%20%20%20%20%20%20included%20in%20that%20dataset.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20If%20you%20want%20to%20learn%20more%20about%20its%20background%2C%20then%20toggle%0A%20%20%20%20%20%20%20%20%20%20%20%20the%20switch%20below.%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20show_dataset_details%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%20Dataset%20description%20as%20by%20the%20author%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7Bdescr%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%20Dataset%20details%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Parameter%20%7C%20Value%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20--------%3A%20%7C%20%3A----%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22%5Cn%22.join(f%22%7C%20%7Bparameter%7D%20%7C%20%7Bvalue%7D%20%7C%22%20for%20parameter%2C%20value%20in%20details.items())%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20show_dataset_details.value%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20mo.md(%22%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20mo)%3A%0A%20%20%20%20%23%20Display%20the%20data%0A%20%20%20%20mo.ui.table(df%2C%20selection%3DNone)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20countries%2C%20geo)%3A%0A%20%20%20%20%23%20Get%20country%20id%20from%20name%0A%20%20%20%20def%20country_id(name)%3A%0A%20%20%20%20%20%20%20%20match%20countries.get(name%3Dname)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20country%20if%20country%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20int(country.numeric)%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20_%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20-1%0A%0A%0A%20%20%20%20%23%20Topological%20dataset%20for%20geographic%20plots%0A%20%20%20%20topo_countries%20%3D%20alt.topo_feature(geo.world_110m.url%2C%20%22countries%22)%0A%20%20%20%20return%20country_id%2C%20topo_countries%0A%0A%0A%40app.cell%0Adef%20_(country_id%2C%20df)%3A%0A%20%20%20%20%23%20Create%20frames%20with%20country%20IDs%20for%20respective%20countries%0A%20%20%20%20df_with_country_IDs%20%3D%20df.copy()%0A%20%20%20%20df_with_country_IDs%5B%22country_id%22%5D%20%3D%20df_with_country_IDs.Country_Region.map(%0A%20%20%20%20%20%20%20%20country_id%0A%20%20%20%20)%0A%20%20%20%20return%20(df_with_country_IDs%2C)%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20features%2C%20pd%2C%20prettify)%3A%0A%20%20%20%20%23%20Prepares%20data%20for%20plotting%0A%20%20%20%20df_long%20%3D%20pd.melt(%0A%20%20%20%20%20%20%20%20df%2C%0A%20%20%20%20%20%20%20%20id_vars%3Dlist(features%5B%3A4%5D)%2C%0A%20%20%20%20%20%20%20%20value_vars%3Dlist(features%5B4%3A%5D)%2C%0A%20%20%20%20%20%20%20%20var_name%3D%22Category%22%2C%0A%20%20%20%20%20%20%20%20value_name%3D%22Value%22%2C%0A%20%20%20%20)%0A%20%20%20%20df_long.Category%20%3D%20df_long.Category.apply(lambda%20c%3A%20prettify%5Bc%5D)%0A%20%20%20%20return%20(df_long%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%23%23%20Visualisations%0A%0A%20%20%20%20This%20little%20demo%20contains%20two%20interactive%2C%20interconnecting%20charts.%20%20The%20top%0A%20%20%20%20is%20a%20choroleph%20map%20that%20shows%20the%20value%20of%20a%20selected%20column%20for%20a%20selected%0A%20%20%20%20date%20on%20a%20world%20map.%20%20To%20select%20the%20column%20and%20date%2C%20use%20the%20dropdown%20menus%0A%20%20%20%20above%20the%20graphic.%20%20The%20second%20plot%20shows%20the%20evolution%20of%20cases%20for%20the%0A%20%20%20%20selected%20country%20over%20the%20entire%20time%20line%20(and%20not%20just%20for%20the%20selected%0A%20%20%20%20date).%0A%0A%20%20%20%20There%20are%20two%20interaction%20modes%20in%20this%20demo%3A%20_dynamic_%20and%20_robust_.%0A%20%20%20%20The%20_dynamic_%20option%20allows%20you%20to%20pick%20a%20country%20you%20are%20interested%20in%0A%20%20%20%20by%20**clicking**%20on%20it%20in%20the%20choroleph%20map%20itself.%20%20The%20selection%20will%20then%0A%20%20%20%20automatically%20update%20the%20details%20plot%20below.%20%20For%20this%20option%2C%20the%0A%20%20%20%20subset%20for%20the%20details%20plot%20is%20drastically%20reduced%20to%20allow%20for%20better%0A%20%20%20%20performance.%20%20(The%20%60Date%60%20axis%20contains%20only%20monday%20reports%20and%20only%0A%20%20%20%20from%20even-numbered%20weeks.)%0A%0A%20%20%20%20In%20the%20_robust_%20version%2C%20you%20need%20to%20pick%20your%20country%20of%20interest%0A%20%20%20%20from%20a%20drop-down%20list.%20%20Clicking%20on%20a%20country%20on%20the%20map%20won't%0A%20%20%20%20propagate%20the%20selection.%20%20But%20the%20details%20plot%20for%20this%20case%20sees%0A%20%20%20%20_all_%20the%20available%20data%2C%20and%20you%20are%20free%20to%20switch%20themes%20without%0A%20%20%20%20losing%20your%20country%20selection.%0A%0A%20%20%20%20And%20that's%20it.%20%20Feel%20free%20to%20try%20it%20out%20and%20explore%20the%20dataset.%0A%20%20%20%20And%20if%20you%20want%20to%20get%20in%20touch%2C%20visit%20me%20on%0A%20%20%20%20%5Barcticneural.de%5D(https%3A%2F%2Farcticneural.de).%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20country_selected%2C%0A%20%20%20%20date_selected%2C%0A%20%20%20%20field_selected%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20use_robust_country_selection%2C%0A)%3A%0A%20%20%20%20mo.hstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20use_robust_country_selection%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20date_selected%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20field_selected%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20country_selected%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20if%20use_robust_country_selection.value%0A%20%20%20%20%20%20%20%20else%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20use_robust_country_selection%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20date_selected%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20field_selected%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20alt%2C%0A%20%20%20%20date_selected%2C%0A%20%20%20%20df_date_filtered%2C%0A%20%20%20%20df_long%2C%0A%20%20%20%20get_selected_field%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20prettify%2C%0A%20%20%20%20topo_countries%2C%0A%20%20%20%20use_robust_country_selection%2C%0A)%3A%0A%20%20%20%20mo.stop(use_robust_country_selection.value)%0A%0A%20%20%20%20select%20%3D%20alt.selection_point(%0A%20%20%20%20%20%20%20%20name%3D%22select%22%2C%0A%20%20%20%20%20%20%20%20fields%3D%5B%22Country_Region%22%5D%2C%0A%20%20%20%20%20%20%20%20on%3D%22click%22%2C%0A%20%20%20%20%20%20%20%20value%3D%22Germany%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20geo_chart_with_selection%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(topo_countries)%0A%20%20%20%20%20%20%20%20.mark_geoshape()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%7Bget_selected_field()%7D%3AQ%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Dprettify%5Bget_selected_field()%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Country_Region%3AN%22%2C%20f%22%7Bget_selected_field()%7D%3AQ%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.transform_lookup(%0A%20%20%20%20%20%20%20%20%20%20%20%20lookup%3D%22id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20from_%3Dalt.LookupData(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_date_filtered%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22country_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%22Country_Region%22%2C%20get_selected_field()%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D330%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Df%22%7Bprettify%5Bget_selected_field()%5D%7D%20on%20%7Bdate_selected.value%7D%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.add_params(select)%0A%20%20%20%20)%0A%0A%20%20%20%20time_chart_totals_dynamic%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_long%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(df_long.Category.apply(lambda%20c%3A%20%22Total%22%20in%20c))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_long.Date.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lambda%20d%3A%20d.day_of_week%20%3D%3D%201%20and%20d.week%20%25%202%20%3D%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_bar(opacity%3D0.5%2C%20width%3D13)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%22Date%3AT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22Value%3AQ%22%2C%20title%3D%22Total%20Cases%22).stack(None)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22Category%3AN%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Date%3AT%22%2C%20%22Value%3AQ%22%2C%20%22Category%3AN%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.transform_filter(select)%0A%20%20%20%20)%0A%0A%20%20%20%20time_chart_new_dynamic%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_long%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(df_long.Category.apply(lambda%20c%3A%20%22New%22%20in%20c%20or%20%22Remaining%22%20in%20c))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_long.Date.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lambda%20d%3A%20d.day_of_week%20%3D%3D%201%20and%20d.week%20%25%202%20%3D%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_line(point%3DTrue)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%22Date%3AT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22Value%3AQ%22%2C%20title%3D%22New%20Cases%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22Category%3AN%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Date%3AT%22%2C%20%22Value%3AQ%22%2C%20%22Category%3AN%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.transform_filter(select)%0A%20%20%20%20)%0A%0A%20%20%20%20geo_chart_with_selection%20%26%20(%0A%20%20%20%20%20%20%20%20time_chart_totals_dynamic%20%2B%20time_chart_new_dynamic%0A%20%20%20%20).resolve_scale(%0A%20%20%20%20%20%20%20%20y%3D%22independent%22%2C%0A%20%20%20%20).properties(%0A%20%20%20%20%20%20%20%20width%3D330%2C%0A%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20title%3Dalt.Title(alt.expr(f'%22Cases%20in%20%22%20%2B%20%7Bselect.name%7D.Country_Region'))%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20alt%2C%0A%20%20%20%20country_selected%2C%0A%20%20%20%20date_selected%2C%0A%20%20%20%20df_country_filtered%2C%0A%20%20%20%20df_date_filtered%2C%0A%20%20%20%20get_selected_field%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20prettify%2C%0A%20%20%20%20topo_countries%2C%0A%20%20%20%20use_robust_country_selection%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20use_robust_country_selection.value)%0A%0A%20%20%20%20geo_chart_robust%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(topo_countries)%0A%20%20%20%20%20%20%20%20.mark_geoshape()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%7Bget_selected_field()%7D%3AQ%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Dprettify%5Bget_selected_field()%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Country_Region%3AN%22%2C%20f%22%7Bget_selected_field()%7D%3AQ%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.transform_lookup(%0A%20%20%20%20%20%20%20%20%20%20%20%20lookup%3D%22id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20from_%3Dalt.LookupData(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_date_filtered%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22country_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%22Country_Region%22%2C%20get_selected_field()%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D330%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Df%22%7Bprettify%5Bget_selected_field()%5D%7D%20on%20%7Bdate_selected.value%7D%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%0A%20%20%20%20time_chart_totals_robust%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_country_filtered%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_country_filtered.Category.apply(lambda%20c%3A%20%22Total%22%20in%20c)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_bar(%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.2%2C%20width%3D1%0A%20%20%20%20%20%20%20%20)%20%20%23%20many%20more%20entries%2C%20so%20use%20much%20smaller%20bars!%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%22Date%3AT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22Value%3AQ%22%2C%20title%3D%22Total%20Cases%22).stack(None)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22Category%3AN%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Date%3AT%22%2C%20%22Value%3AQ%22%2C%20%22Category%3AN%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20time_chart_new_robust%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_country_filtered%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_country_filtered.Category.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lambda%20c%3A%20%22New%22%20in%20c%20or%20%22Remaining%22%20in%20c%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_line(point%3DFalse)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%22Date%3AT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22Value%3AQ%22%2C%20title%3D%22New%20Cases%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22Category%3AN%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Date%3AT%22%2C%20%22Value%3AQ%22%2C%20%22Category%3AN%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20geo_chart_robust%20%26%20(%0A%20%20%20%20%20%20%20%20time_chart_totals_robust%20%2B%20time_chart_new_robust%0A%20%20%20%20).resolve_scale(%0A%20%20%20%20%20%20%20%20y%3D%22independent%22%2C%0A%20%20%20%20).properties(%0A%20%20%20%20%20%20%20%20width%3D330%2C%0A%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20title%3Df%22Cases%20in%20%7Bcountry_selected.value%7D%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20features%2C%20mo%2C%20pd%2C%20prettify)%3A%0A%20%20%20%20_dates%20%3D%20df%5B%22Date%22%5D.sort_values(ascending%3DFalse).unique()%0A%0A%0A%20%20%20%20def%20format_date(date)%3A%0A%20%20%20%20%20%20%20%20return%20date.strftime(%22%25Y-%25m-%25d%22)%0A%0A%0A%20%20%20%20get_selected_date%2C%20set_selected_date%20%3D%20mo.state(_dates%5B0%5D)%0A%20%20%20%20get_selected_field%2C%20set_selected_field%20%3D%20mo.state(df.columns%5B7%5D)%0A%0A%20%20%20%20date_selected%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20list(map(format_date%2C%20_dates))%2C%0A%20%20%20%20%20%20%20%20value%3Dformat_date(get_selected_date())%2C%0A%20%20%20%20%20%20%20%20on_change%3Dlambda%20d%3A%20set_selected_date(pd.to_datetime(d))%2C%0A%20%20%20%20%20%20%20%20label%3D%22Date%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20field_selected%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20list(map(lambda%20f%3A%20prettify%5Bf%5D%2C%20features%5B3%3A%5D))%2C%0A%20%20%20%20%20%20%20%20value%3Dprettify%5Bget_selected_field()%5D%2C%0A%20%20%20%20%20%20%20%20on_change%3Dlambda%20f%3A%20set_selected_field(f.replace(%22%20%22%2C%20%22_%22))%2C%0A%20%20%20%20%20%20%20%20label%3D%22Column%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20country_selected%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20df%5B%22Country_Region%22%5D.unique()%2C%0A%20%20%20%20%20%20%20%20value%3D%22Germany%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Country%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20use_robust_country_selection%20%3D%20mo.ui.switch(%0A%20%20%20%20%20%20%20%20label%3D%22Use%20robust%20country%20selection%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20show_dataset_details%20%3D%20mo.ui.switch(%0A%20%20%20%20%20%20%20%20label%3D%22Show%20dataset%20details%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20country_selected%2C%0A%20%20%20%20%20%20%20%20date_selected%2C%0A%20%20%20%20%20%20%20%20field_selected%2C%0A%20%20%20%20%20%20%20%20format_date%2C%0A%20%20%20%20%20%20%20%20get_selected_date%2C%0A%20%20%20%20%20%20%20%20get_selected_field%2C%0A%20%20%20%20%20%20%20%20show_dataset_details%2C%0A%20%20%20%20%20%20%20%20use_robust_country_selection%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(df_with_country_IDs%2C%20get_selected_date)%3A%0A%20%20%20%20df_date_filtered%20%3D%20df_with_country_IDs%5B%0A%20%20%20%20%20%20%20%20df_with_country_IDs.Date%20%3D%3D%20get_selected_date()%0A%20%20%20%20%5D%0A%20%20%20%20return%20(df_date_filtered%2C)%0A%0A%0A%40app.cell%0Adef%20_(country_selected%2C%20df_long)%3A%0A%20%20%20%20df_country_filtered%20%3D%20df_long%5B%0A%20%20%20%20%20%20%20%20(df_long.Country_Region%20%3D%3D%20country_selected.value)%20%26%20(df_long.Value%20%3E%3D%200)%0A%20%20%20%20%5D%0A%20%20%20%20return%20(df_country_filtered%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Note%20that%20if%20you%20came%20here%20from%20my%20website%2C%0A%20%20%20%20%5Barcticneural.de%5D(https%3A%2F%2Farcticneural.de)%2C%20then%20you%20may%20have%20seen%0A%20%20%20%20screenshots%20of%20the%20graphic%20in%20various%20different%20themes.%20%20Theme%0A%20%20%20%20selection%20is%20disabled%20for%20the%20web%20version%20of%20this%20demo%20due%20to%0A%20%20%20%20compatibility%20and%20portability%20reasons.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
